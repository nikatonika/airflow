# Monthly Client Activity DAG

Этот проект включает DAG для Apache Airflow, предназначенный для ежемесячного расчёта витрины активности клиентов. Витрина формируется на основе суммы и количества транзакций клиентов по различным продуктам. Реализована возможность параллельной обработки данных по продуктам для оптимизации производительности.

## Описание

DAG `monthly_activity_dag_VeronikaZaslavskaia` запускается 5-го числа каждого месяца. Основная цель этого процесса — извлечь данные о транзакциях клиентов, преобразовать их для определения активности по продуктам и загрузить результаты в файл для последующего анализа.

### Этапы работы DAG

1. **Extract**: Извлечение данных из файла `profit_table.csv`, содержащего информацию о транзакциях клиентов по продуктам.
2. **Transform**: Выполнение преобразования данных с помощью функции `transform` для определения активности клиентов.
3. **Load**: Сохранение итоговых данных в `flags_activity.csv`, добавляя новые данные к существующим без перезаписи предыдущих.

### Параллельная обработка

Для оптимизации производительности реализована возможность параллельной обработки данных по каждому из 10 продуктов. Каждый продукт обрабатывается в отдельной задаче, что позволяет значительно сократить время обработки больших объемов данных.

## Требования к системе

- Python 3.8 или выше
- Apache Airflow 2.0 или выше
- Библиотека Pandas

## Установка зависимостей

```bash
pip install apache-airflow pandas